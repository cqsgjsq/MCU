
														2019 summary
	截止现在，今年手上开发的项目有五菱CN210系列和CN220C_E，广汽A06_7WDCT，长城141E，长安S202。
每个项目都遇到过大大小小的问题，虽然有些问题确实很弱智，但同样的问题自己没有犯两次，所有的问题都是有原因的，实际的状态跟心中的状态是不一样的，如果没分析出来原因，那么一定是某个地方没有考虑到！每个项目中都有值得学习和考虑的地方。


硬件上的典型案例:
Q：上汽五菱项目低功耗问题（进入低功耗后，暗电流差距1mA多）
A：1.检查进入低功耗流程是否有误？ 2.根据外部电路配置IO口，普通IO口配置为输出低电平

怀疑对象：
低功耗期间时钟用的是LSI，HSE没有关闭？
实验结果：MCU不能选着LSI用做Fmaster，因为option byte默认禁止LSI当作fmaster!

Do：AMU或者halt模式期间给芯片加热，低功耗会下降很多，随着温度上升，低功耗会增大（AMU状态下，LSI受温度影响较大）
1.给功耗差别大PCB交换芯片，看是贴片的问题还是芯片的问题？
2.检查IO口是否真的如预期配置，such as:有些引脚只有OD
3.检查各个外设所消耗电流
4.进入低功耗前检查寄存器value是否如预期？
5.去掉外部电路，check芯片自身功耗
6.理论功耗+外部电路，理论与实际差别是否可接受
7.是否开启WD？

最终原因：芯片内部还有很多IO口,我们只拉低外部能看到的引脚，其实内部还有很多引脚，我们也需要拉低内部引脚，使其处于最低功耗

其实datasheet相关PIN图下面一直都有提示，不过自己确实没看数据手册，在开发前，应该先看MCU基本信息的，有没什么特别注意的事项，如果当初开发前了解了相关事项，就不会浪费起码好几天的开发时间和10块开发板了！

软件上的典型案例:
Q:在不同的电压条件下，KL15上电，一定几率会进入低功耗，然后再wake up再进入低功耗！
A:检查硬件，电路真的一点问题都没有，然后检查软件上电逻辑，看似也没有什么逻辑错误，量产这么久了。。。
通过增加报文调试代码发现KL15上电后，初始化中有个操作eeprom的函数，该函数执行时间过长，导致IGN判断没有完成，默认是OFF,程序中原来也有个限制时间参数，但由于该函数时间过长所以（该函数执行时间不确定，所以偶尔会导致错误），该限制没有起到作用！
感想：程序执行过程中，可能因为某些函数执行时间过长+变量滤波，导致该变量为默认值就参与错误的程序判断了，
因此：在一些参与到滤波的变量中，需要特别的注意，或者添加一个该变量的开关！很重要！
或者用相对时间而不是用绝对时间，在一个函数结束后开始计时。
软件开发中需要知道某些函数的执行时间，如果该函数执行时间过长，会影响到后续逻辑！

结构上的典型案例:
结构内部，M-跟机械外壳接触了，外壳跟MLX芯片的5V端口短路，从而导致电机故障（该问题困扰了一周，很低级的错误）
结论：考虑问题时，从源头开始考虑，不能错过细节，暴露出来的问题一定要解决，实在不行把其他干扰项去掉！
实验：1.把M+/-2根线反接，电机老是在反转的时候异常（注意：这个时候肯定可以确定其中一根motor线短路了）
2.把电机模块从机构拿出来，运行没有问题，放进去问题立即浮现，此时也可以判断，motor线有问题！
3.用示波器直接观察motor 2根线，不放在结构里面，电压差正常，放在结构里，只有motor-波形不正常，motor+运行正常，motor2根导线反接，也是motor-异常（此时也可以判定motor-肯定受到干扰了）

本次问题属于结构问题，但本质上这个问题很快就应该发现，不能随便听信别人的话，要自己判断，从最低层判断
做开发，其实很多问题后面来看，都是很简单的问题，重要的是要一个一个排查，特别是不要放过每一个细节，应该对每一个软件都要进行实物仿真调试的，看数据的流向，和该模块的执行时间，是有存在死循环的，对每一个while1 都应该加上一个限制，官方给的demo软件模块也应该进行排查，毕竟也确实发生过死循环的情况。
	这一年里最大的收获是自己证明了开发中遇到的问题都是有原因的，所以没找到原因是因为自己视野还不够宽阔，没抓到异常现象。总体来说，对于工作上，自己对2019还是很满意的！
